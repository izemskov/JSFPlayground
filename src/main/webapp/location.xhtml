<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:b="http://bootsfaces.net/ui">
<h:head>
    <title>JSF Game</title>
    <h:outputStylesheet name="css/styles.css"/>
</h:head>
<h:body style="margin: 0;">
    <h:panelGroup layout="block" id="mainContainer" styleClass="mainContainer">
        <h:form>
            <b:poll id="poll" stop="#{false}" interval="100" update="location1" execute="location1"/>

            <b:panelGrid id="location1" styleClass="location1" columns="1">
                <h:panelGroup layout="block" id="location2" styleClass="location2">
                    <h:panelGroup layout="block"
                                  id="player"
                                  style="width: #{gameBean.person.width}px; height: #{gameBean.person.getTotalHeight()}px;
                                         background-image: url('#{gameBean.person.image}');
                                         background-repeat: no-repeat;
                                         background-position: center bottom;
                                         text-align: center;
                                         position: absolute;
                                         top: #{gameBean.person.getTopPosition()}px; left: #{gameBean.person.getLeftPosition()}px;">
                        <h:panelGroup layout="block" style="margin-bottom: 10px;" rendered="#{gameBean.getPersonLastMessage(gameBean.person.name) ne null}">
                            <table cellpadding="0" cellspacing="0" width="100" border="0">
                                <tr style="height: 7px;">
                                    <td width="7" nowrap="nowrap" height="7" class="dialog-left-top"><p:graphicImage name="images/DIALOG/px.gif" width="7" height="1"/></td>
                                    <td width="100%" height="7" class="dialog-top"></td>
                                    <td width="7" nowrap="nowrap" height="7" class="dialog-right-top"><p:graphicImage name="images/DIALOG/px.gif" width="7" height="1"/></td>
                                </tr>
                                <tr>
                                    <td width="7" nowrap="nowrap" height="7" class="dialog-left"><p:graphicImage name="images/DIALOG/px.gif" width="7" height="1"/></td>
                                    <td width="100%" class="dialog">
                                        <p:outputLabel styleClass="dialog-text" value="#{gameBean.getPersonLastMessage(gameBean.person.name)}"/>
                                    </td>
                                    <td width="7" nowrap="nowrap" height="7" class="dialog-right"><p:graphicImage name="images/DIALOG/px.gif" width="7" height="1"/></td>
                                </tr>
                                <tr style="height: 7px;">
                                    <td width="7" nowrap="nowrap" height="7" class="dialog-left-bottom"><p:graphicImage name="images/DIALOG/px.gif" width="7" height="1"/></td>
                                    <td width="100%" height="7" class="dialog-bottom"/>
                                    <td width="7" nowrap="nowrap" height="7" class="dialog-right-bottom"><p:graphicImage name="images/DIALOG/px.gif" width="7" height="1"/></td>
                                </tr>
                            </table>
                        </h:panelGroup>
                        <p:outputLabel styleClass="playerName"
                                       style="margin-top: #{gameBean.person.getTotalHeight()}px"
                                       value="#{gameBean.person.name}"/>
                    </h:panelGroup>

                    <ui:repeat value="#{gameBean.otherPersons}" var="otherPerson">
                        <h:panelGroup layout="block"
                                      id="enemy#{otherPerson.uuid}"
                                      style="width: #{otherPerson.width}px; height: #{otherPerson.getTotalHeight()}px;
                                         background-image: url('#{otherPerson.image}');
                                         background-repeat: no-repeat;
                                         background-position: center bottom;
                                         text-align: center;
                                         position: absolute;
                                         top: #{otherPerson.getTopPosition()}px; left: #{otherPerson.getLeftPosition()}px;">
                            <h:panelGroup layout="block" style="margin-bottom: 10px;" rendered="#{gameBean.getPersonLastMessage(otherPerson.name) ne null}">
                                <table cellpadding="0" cellspacing="0" width="100" border="0">
                                    <tr style="height: 7px;">
                                        <td width="7" nowrap="nowrap" height="7" class="dialog-left-top"><p:graphicImage name="images/DIALOG/px.gif" width="7" height="1"/></td>
                                        <td width="100%" height="7" class="dialog-top"></td>
                                        <td width="7" nowrap="nowrap" height="7" class="dialog-right-top"><p:graphicImage name="images/DIALOG/px.gif" width="7" height="1"/></td>
                                    </tr>
                                    <tr>
                                        <td width="7" nowrap="nowrap" height="7" class="dialog-left"><p:graphicImage name="images/DIALOG/px.gif" width="7" height="1"/></td>
                                        <td width="100%" class="dialog">
                                            <p:outputLabel styleClass="dialog-text" value="#{gameBean.getPersonLastMessage(otherPerson.name)}"/>
                                        </td>
                                        <td width="7" nowrap="nowrap" height="7" class="dialog-right"><p:graphicImage name="images/DIALOG/px.gif" width="7" height="1"/></td>
                                    </tr>
                                    <tr style="height: 7px;">
                                        <td width="7" nowrap="nowrap" height="7" class="dialog-left-bottom"><p:graphicImage name="images/DIALOG/px.gif" width="7" height="1"/></td>
                                        <td width="100%" height="7" class="dialog-bottom"/>
                                        <td width="7" nowrap="nowrap" height="7" class="dialog-right-bottom"><p:graphicImage name="images/DIALOG/px.gif" width="7" height="1"/></td>
                                    </tr>
                                </table>
                            </h:panelGroup>
                            <p:outputLabel styleClass="enemyName"
                                           style="margin-top: #{otherPerson.getTotalHeight()}px"
                                           value="#{otherPerson.name}"/>
                        </h:panelGroup>
                    </ui:repeat>
                </h:panelGroup>
            </b:panelGrid>
        </h:form>
    </h:panelGroup>
</h:body>
</html>
